# 데드락

두개 이상의 프로세스들이 서로가 가진 자원을 기다리며 중단된 상태(교착상태)

### 발생 조건

- **상호 배제** : 한번에 한 프로세스만 자원에 접근할 수 있다
한 프로세스가 자원을 독점하면 다른 프로세스는 접근 불가
- **점유 대기** : 특정 프로세스가 점유한 자원을 다른 프로세스가 요청하는 상태
- **비선점** : 다른 프로세스의 자원을 강제적으로 가져올 수 없다.
- **환형대기** : 서로가 서로의 자원을 요구하는 상황

### 해결 방법 
1. **예방(prevention)** : 데드락 원인이 발생하지 않도록 하는 것(비효율적)
2. **회피(avoidance)** : 교착 상태 발생 시 피해나가는 방법
3.  **탐지(detection)**, **회복(Recovery)** : 교착 상태가 되도록 허용한 다음 회복시키는 방법

### 예방

- 자원의 상호 배제 조건 방지 : 한 번에 여러 프로세스가 공유 자원을 사용할 수 있게 한다 (동기화 관련 문제가 발생할 수 있음)

- 점유 대기 조건 방지 : 프로세스 실행에 필요한 모든 자원을 한꺼번에 요구하고 허용할 때까지 작업을 보류(또다른 자원을 점유하기 위한 대기 조건을 성립하지 않도록 함)

- 비선점 조건 방지 : 보다 높은 우선순위의 프로세스가 이미 할당된 자원을 선점할 수 있도록 한다.

- 순환 대기 조건 방지 : 자원을 순환 형태로 대기하지 않도록 일정한 한 쪽 방향으로만 자원을 요구할 수 있도록 한다.

##### 회피
자원을 할당한 후에도 시스템이 항상 Safe state에 있을 수 있도록 할당을 허용하는 알고리즘

**safe state** : 프로세스들이 요청하는 모든 자원을, 데드락을 발생시키지 않으면서 차례로 모두에게 할당해 줄 수 있다면 안정 상태
**safe sequence** : 특정한 순서로 프로세스들에게 자원을 할당, 실행 및 종료 등의 작업을 할 때 데드락이 발생하지 않는 순서를 찾을 수 있다면, 그것을 안전 순서


은행원 알고리즘 : 총자원양과 현재 할당된 자원양을 기준으로 안정, 불안정을 나누고 안정상태로 가도록 자원을 할당하는 알고리즘

미리 최대 자원 요구량을 알아야 하고, 할당할 수 있는 자원 수가 일정해야 하는 등 사용에 있어 제약조건이 많고, 그에 따른 자원 이용도 하락 등 단점도 존재


##### 탐지
현재 자원 할당 상태를 통해 데드락 발생을 탐색(Allocation, Request, Available 등)

##### 회복
데드락을 회복하기 위한 방법
- **데드락인 모든 프로세스를 중단시키는 방법** : 연산중인 프로세스도 중단되어 결과가 폐기될 수 있는 부작용이 발생
- **프로세스를 하나씩 중단 시킬 때마다 탐지 알고리즘으로 데드락을 탐지하면서 회복시키는 방법** : 매번 탐지 알고리즘을 수행해야 하므로 부담이 되는 작업일 수 있음

- 프로세스에 할당된 자원을 선점해서, 교착 상태를 해결할 때까지 그 자원을 다른 프로세스에 할당해 주는 방법

---
### 출처
[[운영체제] 데드락(Deadlock, 교착 상태)이란?](https://chanhuiseok.github.io/posts/cs-2/)
